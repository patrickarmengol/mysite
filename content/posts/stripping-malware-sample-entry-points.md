---
title: "Stripping Malware Sample Entry Points"
date: 2020-01-31T23:40:44Z
draft: false
toc: false
images:
tags:
  - project
  - security
---

## Backstory

While going through [Malware Data Science](https://www.malwaredatascience.com/), I noticed that the malware samples included in the book's 'code and data' download had their entry points redacted.

![book_code_download](/img/stripping-malware-sample-entry-points/book_code_download.png)
![show_ep_value](/img/stripping-malware-sample-entry-points/show_ep_value.png)

I'm assuming this was done so that live samples wouldn't be hosted directly from the site, or so that people working through the book would be unable to accidently infect themselves.

I thought it would be a nice exercise to create a tool to do this for a given directory of samples.


## Project

I've written a short script and put it up on github.
https://github.com/patrickarmengol/EPstripper

Feed it a file or directory and it will create a copy of each PE file with its entry points replaced.


## Example

![example_before](/img/stripping-malware-sample-entry-points/example_before.png)
![example_command](/img/stripping-malware-sample-entry-points/example_command.png)
![example_after](/img/stripping-malware-sample-entry-points/example_after.png)
